# TapTap Godot 3.x æ’ä»¶å·¥å…·è¯´æ˜

## ğŸ“¦ æ’ä»¶å†…å®¹

### æ ¸å¿ƒæ–‡ä»¶
- **`plugin.cfg`** - æ’ä»¶é…ç½®æ–‡ä»¶
- **`plugin.gd`** - æ’ä»¶åˆå§‹åŒ–è„šæœ¬
- **`taptap.gd`** - TapTap SDK ä¸»è¦æ¥å£ç±»

### åŠ å¯†ç›¸å…³å·¥å…·
- **`TapTapConfigWindow.gd`** - Token åŠ å¯†é…ç½®å·¥å…·ï¼ˆGUIï¼‰
- **`generate_secure_key.gd`** - å¯†é’¥ç”Ÿæˆå·¥å…·ï¼ˆå‘½ä»¤è¡Œï¼‰

### ç¤ºä¾‹æ–‡ä»¶
- **`example_usage.gd`** - ä½¿ç”¨ç¤ºä¾‹ä»£ç 

## ğŸ”§ å·¥å…·ä½¿ç”¨æ–¹æ³•

### 1. Token åŠ å¯†é…ç½®å·¥å…·ï¼ˆæ¨èï¼‰

è¿™æ˜¯ä¸€ä¸ªå›¾å½¢ç•Œé¢å·¥å…·ï¼Œæä¾›å®Œæ•´çš„å¯†é’¥ç®¡ç†å’Œ Token åŠ å¯†åŠŸèƒ½ã€‚

**å¯åŠ¨æ–¹å¼**ï¼š
```
Project â†’ Tools â†’ TapTap RSA å¯†é’¥é…ç½®
```

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- ğŸ”‘ å¯†é’¥ç®¡ç†ï¼šè¯»å–/ä¿å­˜/ç”Ÿæˆå¯†é’¥
- ğŸ” Token åŠ å¯†ï¼šè¾“å…¥æ˜æ–‡ Tokenï¼Œè¾“å‡ºåŠ å¯†ç»“æœ
- ğŸ“‹ ä»£ç ç”Ÿæˆï¼šè‡ªåŠ¨ç”Ÿæˆ Java è§£å¯†ä»£ç 
- ğŸ’¾ æ–‡ä»¶åŒæ­¥ï¼šè‡ªåŠ¨ä¸ Android èµ„æºæ–‡ä»¶åŒæ­¥

**ä½¿ç”¨æµç¨‹**ï¼š
1. æ‰“å¼€é…ç½®å·¥å…·
2. ç¡®è®¤æˆ–ç”Ÿæˆå¯†é’¥
3. è¾“å…¥ Client Token
4. ç‚¹å‡»åŠ å¯†ç”Ÿæˆç»“æœ
5. å¤åˆ¶åŠ å¯† Token å’Œ Java ä»£ç 

### 2. å¯†é’¥ç”Ÿæˆå·¥å…·ï¼ˆå‘½ä»¤è¡Œï¼‰

è¿™æ˜¯ä¸€ä¸ª EditorScript å·¥å…·ï¼Œç”¨äºå¿«é€Ÿç”Ÿæˆå’Œæ›¿æ¢å¯†é’¥ã€‚

**å¯åŠ¨æ–¹å¼**ï¼š
1. åœ¨ Godot ç¼–è¾‘å™¨ä¸­æ‰“å¼€ `addons/godot3-taptap/generate_secure_key.gd`
2. æŒ‰ **Ctrl+Shift+X** æˆ–ç‚¹å‡» **File â†’ Run**

**åŠŸèƒ½ç‰¹æ€§**ï¼š
- ğŸ² ç”Ÿæˆå®‰å…¨çš„éšæœºå¯†é’¥
- ğŸ’¾ è‡ªåŠ¨ä¿å­˜åˆ° Android èµ„æºæ–‡ä»¶
- ğŸ“ æä¾›è¯¦ç»†çš„æ“ä½œæŒ‡å¼•

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ‰¹é‡å¯†é’¥æ›´æ–°
- è‡ªåŠ¨åŒ–è„šæœ¬é›†æˆ
- å¿«é€Ÿå¯†é’¥è½®æ¢

## ğŸ”’ å®‰å…¨é…ç½®

### å¯†é’¥æ–‡ä»¶ä½ç½®
```
android/build/res/raw/taptap_decrypt_key.txt
```

### å¯†é’¥æ ¼å¼
- **æ ¼å¼**ï¼šçº¯æ–‡æœ¬ï¼Œå•è¡Œå¯†é’¥
- **é•¿åº¦**ï¼šå»ºè®® 16-32 ä¸ªå­—ç¬¦
- **å­—ç¬¦é›†**ï¼šå­—æ¯æ•°å­—ç»„åˆï¼Œé¿å…ç‰¹æ®Šå­—ç¬¦

### ç‰ˆæœ¬æ§åˆ¶
å»ºè®®å°†å¯†é’¥æ–‡ä»¶æ·»åŠ åˆ° `.gitignore`ï¼š
```gitignore
# TapTap å¯†é’¥æ–‡ä»¶
android/build/res/raw/taptap_decrypt_key.txt
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1ï¼šé…ç½®å¯†é’¥
```
Project â†’ Tools â†’ TapTap RSA å¯†é’¥é…ç½®
ç‚¹å‡» "ğŸ² ç”Ÿæˆéšæœºå¯†é’¥" â†’ "ğŸ’¾ ä¿å­˜å¯†é’¥"
```

### æ­¥éª¤ 2ï¼šåŠ å¯† Token
```
åœ¨é…ç½®å·¥å…·ä¸­è¾“å…¥ Client Token
ç‚¹å‡» "ğŸ” ç”ŸæˆåŠ å¯† Token"
å¤åˆ¶åŠ å¯†ç»“æœ
```

### æ­¥éª¤ 3ï¼šæ›´æ–°ä»£ç 
```gdscript
# åœ¨æ¸¸æˆä¸­ä½¿ç”¨åŠ å¯† Token
TapTap.initSdkWithEncryptedToken("åŠ å¯†åçš„Token", clientId, false)
```

### æ­¥éª¤ 4ï¼šæ›´æ–° Java ä»£ç 
å°†é…ç½®å·¥å…·ç”Ÿæˆçš„ Java ä»£ç æ·»åŠ åˆ° `Godot3TapTap.java` ä¸­ã€‚

## ğŸ“‹ API å‚è€ƒ

### TapTap ä¸»è¦æ–¹æ³•

```gdscript
# æ™®é€šåˆå§‹åŒ–ï¼ˆæ˜æ–‡ Tokenï¼‰
TapTap.initSdk(clientId: String, clientToken: String, enableLog: bool)

# åŠ å¯†åˆå§‹åŒ–ï¼ˆæ¨èï¼‰
TapTap.initSdkWithEncryptedToken(encryptedToken: String, clientId: String, enableLog: bool)

# ç™»å½•
TapTap.startTapLogin(permissions: Array)

# è·å–ç”¨æˆ·ä¿¡æ¯
TapTap.getCurrentUser()

# ç™»å‡º
TapTap.logout()
```

### åŠ å¯†å·¥å…·æ–¹æ³•

```gdscript
# TapTapConfigWindow.gd ä¸»è¦æ–¹æ³•
_load_or_create_key()          # åŠ è½½æˆ–åˆ›å»ºå¯†é’¥
_save_key_to_file(key: String) # ä¿å­˜å¯†é’¥åˆ°æ–‡ä»¶
_simple_encrypt(text: String)   # XOR åŠ å¯†
_generate_java_decrypt_code()   # ç”Ÿæˆ Java ä»£ç 

# generate_secure_key.gd ä¸»è¦åŠŸèƒ½
_run()  # ç”Ÿæˆéšæœºå¯†é’¥å¹¶ä¿å­˜
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: é…ç½®å·¥å…·æ— æ³•ä¿å­˜å¯†é’¥**
A: æ£€æŸ¥ `android/build/res/raw/` ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œæ‰‹åŠ¨åˆ›å»ºè¯¥ç›®å½•ã€‚

**Q: åŠ å¯† Token åœ¨ Android ç«¯è§£å¯†å¤±è´¥**
A: ç¡®è®¤å¯†é’¥æ–‡ä»¶å†…å®¹ä¸é…ç½®å·¥å…·ä¸­çš„å¯†é’¥ä¸€è‡´ã€‚

**Q: æ‰¾ä¸åˆ°é…ç½®å·¥å…·èœå•**
A: ç¡®ä¿æ’ä»¶å·²å¯ç”¨ï¼Œé‡å¯ Godot ç¼–è¾‘å™¨ã€‚

### è°ƒè¯•æ–¹æ³•

1. **æ£€æŸ¥å¯†é’¥æ–‡ä»¶**ï¼š
   ```
   cat android/build/res/raw/taptap_decrypt_key.txt
   ```

2. **éªŒè¯åŠ å¯†åŠŸèƒ½**ï¼š
   ä½¿ç”¨é…ç½®å·¥å…·åŠ å¯†æµ‹è¯• Tokenï¼Œæ£€æŸ¥è¾“å‡ºæ˜¯å¦æ­£å¸¸ã€‚

3. **æŸ¥çœ‹æ—¥å¿—**ï¼š
   åœ¨ Android ç«¯æŸ¥çœ‹è§£å¯†ç›¸å…³çš„é”™è¯¯æ—¥å¿—ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
godot3_taptap/
â”œâ”€â”€ addons/godot3-taptap/              # æ’ä»¶æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ plugin.cfg                     # æ’ä»¶é…ç½®
â”‚   â”œâ”€â”€ plugin.gd                      # æ’ä»¶å…¥å£
â”‚   â”œâ”€â”€ taptap.gd                      # ä¸»æ¥å£
â”‚   â”œâ”€â”€ TapTapConfigWindow.gd          # é…ç½®å·¥å…·
â”‚   â”œâ”€â”€ generate_secure_key.gd         # å¯†é’¥ç”Ÿæˆå™¨
â”‚   â””â”€â”€ example_usage.gd               # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ android/build/res/raw/
â”‚   â””â”€â”€ taptap_decrypt_key.txt         # å¯†é’¥æ–‡ä»¶
â”œâ”€â”€ Scenes/
â”‚   â””â”€â”€ Main.gd                        # æ¸¸æˆä¸»åœºæ™¯
â””â”€â”€ ğŸ“„ æ–‡æ¡£æ–‡ä»¶...
```

## ğŸ“„ ç›¸å…³æ–‡æ¡£

- **`TapTap_TokenåŠ å¯†é…ç½®æŒ‡å—_v2.md`** - è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—
- **`android/Androidèµ„æºé…ç½®æŒ‡å—.md`** - Android é…ç½®è¯´æ˜

## ğŸ”„ ç‰ˆæœ¬å†å²

### v2.0 (å½“å‰ç‰ˆæœ¬)
- âœ… å¯é…ç½®å¯†é’¥ç³»ç»Ÿ
- âœ… å›¾å½¢ç•Œé¢é…ç½®å·¥å…·
- âœ… è‡ªåŠ¨æ–‡ä»¶ç®¡ç†
- âœ… ç®€åŒ–çš„å·¥ä½œæµç¨‹

### v1.0
- âœ… åŸºç¡€ XOR åŠ å¯†
- âœ… å›ºå®šå¯†é’¥ç³»ç»Ÿ
- âœ… æ‰‹åŠ¨é…ç½®æµç¨‹